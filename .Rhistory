plotdf[2,1] <- "I would hire a Veterinary Technician Specialist (VTS) over a technician without the specialist designation if more VTS’s were available (Privately-owned practive)"
plotdf[2,2] <- mean((grepl("Strongly agree" ,d$hire_vts)|grepl("Somewhat agree" ,d$hire_vts)) & grepl("Privately owned " ,d$private_practice))*100
plotdf
df <- d[grepl("Privately owned " ,d$private_practice),]
dim(d)
dim(df)
plotdf[2,2] <- mean(grepl("Strongly agree" ,df$hire_vts)|grepl("Somewhat agree" ,df$hire_vts))*100
plotdf
# 2) Column EI: Please indicate your level of agreement with the following statements. If you don’t know enough about VTS’s to answer,
#please leave it blank: - I would offer a higher salary for VTS’s compared to veterinary technicians without the specialist designation.
colnames(d)[grepl("higher salary for VTS", colnames(d))]
d <- d %>% rename(high_sal_vts=`Please indicate your level of agreement with the following statements. If you don’t know enough about VTS’s to answer, please leave it blank: - I would offer a higher salary for VTS’s compared to veterinary technicians without the specialist designation.`)
unique(d$high_sal_vts)
plotdf[3,1] <- "I would offer a higher salary for VTS’s compared to veterinary technicians without the specialist designation. (Overall)"
plotdf[3,2] <- mean(grepl("Strongly agree" ,d$high_sal_vts)|grepl("Somewhat agree" ,d$high_sal_vts))*100
plotdf[4,1] <- "I would offer a higher salary for VTS’s compared to veterinary technicians without the specialist designation. (Privately-owned practive)"
plotdf[4,2] <- mean(grepl("Strongly agree" ,df$high_sal_vts)|grepl("Somewhat agree" ,df$high_sal_vts))*100
plotdf
df <- d[grepl("Privately owned " ,d$private_practice),]
plotdf[4,2] <- mean(grepl("Strongly agree" ,df$high_sal_vts)|grepl("Somewhat agree" ,df$high_sal_vts))*100
plotdf
ggplot(plotdf, aes(x=group, y=perc_agree)) + geom_bar() + coord_flip()
plotdf
ggplot(data = plotdf, aes(x = group, y = perc_agree)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Percent agreement by practice type",
x = "",
y = "Percent somewhat or strongly agree") +
theme_minimal()
ggplot(data = plotdf, aes(x = group, y = perc_agree)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Percent agreement by practice type",
x = "",
y = "Percent somewhat or strongly agree") +
theme_minimal()+ coord_flip()
ggsave("C:/Users/andre/Dropbox/Becky help/Becky help - vet survey/percent_agree_by_practice_type.png", p, width = 10, height = 6, units = "in", dpi = 300)
p <- ggplot(data = plotdf, aes(x = group, y = perc_agree)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Percent agreement by practice type",
x = "",
y = "Percent somewhat or strongly agree") +
theme_minimal()+ coord_flip()
ggsave(p, "C:/Users/andre/Dropbox/Becky help/Becky help - vet survey/percent_agree_by_practice_type.png", width = 10, height = 6, units = "in", dpi = 300)
p <- ggplot(data = plotdf, aes(x = group, y = perc_agree)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Percent agreement by practice type",
x = "",
y = "Percent somewhat or strongly agree") +
theme_minimal()+ coord_flip()
ggsave(p, file="C:/Users/andre/Dropbox/Becky help/Becky help - vet survey/percent_agree_by_practice_type.png", width = 10, height = 6, units = "in", dpi = 300)
plotdf <- data.frame(group=rep(NA,4), perc_agree=rep(NA,4))
plotdf[1,1] <- "I would hire a Veterinary Technician Specialist (VTS) over a technician\nwithout the specialist designation if more VTS’s were available (Overall)"
plotdf[1,2] <- mean(grepl("Strongly agree" ,d$hire_vts)|grepl("Somewhat agree" ,d$hire_vts))*100
plotdf[2,1] <- "I would hire a Veterinary Technician Specialist (VTS) over a technician\nwithout the specialist designation if more VTS’s were available (Privately-owned practive)"
plotdf[2,2] <- mean(grepl("Strongly agree" ,df$hire_vts)|grepl("Somewhat agree" ,df$hire_vts))*100
# 2) Column EI: Please indicate your level of agreement with the following statements. If you don’t know enough about VTS’s to answer,
#please leave it blank: - I would offer a higher salary for VTS’s compared to veterinary technicians without the specialist designation.
plotdf[3,1] <- "I would offer a higher salary for VTS’s compared to veterinary technicians\nwithout the specialist designation. (Overall)"
plotdf[3,2] <- mean(grepl("Strongly agree" ,d$high_sal_vts)|grepl("Somewhat agree" ,d$high_sal_vts))*100
plotdf[4,1] <- "I would offer a higher salary for VTS’s compared to veterinary technicians\nwithout the specialist designation. (Privately-owned practive)"
plotdf[4,2] <- mean(grepl("Strongly agree" ,df$high_sal_vts)|grepl("Somewhat agree" ,df$high_sal_vts))*100
p <- ggplot(data = plotdf, aes(x = group, y = perc_agree)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Percent agreement by practice type",
x = "",
y = "Percent somewhat or strongly agree") +
theme_minimal()+ coord_flip()
ggsave(p, file="C:/Users/andre/Dropbox/Becky help/Becky help - vet survey/percent_agree_by_practice_type.png", width = 10, height = 5, units = "in", dpi = 300)
ggsave(p, file="C:/Users/andre/Dropbox/Becky help/Becky help - vet survey/percent_agree_by_practice_type.jpeg", width = 10, height = 5, units = "in", dpi = 300)
plotdf <- data.frame(question=rep(NA,4), perc_agree=rep(NA,4), group=rep(c("Strongly agree","Strongly agree"),2))
plotdf[1,1] <- "I would hire a Veterinary Technician Specialist (VTS) over a technician\nwithout the specialist designation if more VTS’s were available (Overall)"
plotdf[1,2] <- mean(grepl("Strongly agree" ,d$hire_vts)|grepl("Somewhat agree" ,d$hire_vts))*100
plotdf[2,1] <- "I would hire a Veterinary Technician Specialist (VTS) over a technician\nwithout the specialist designation if more VTS’s were available (Privately-owned practive)"
plotdf[2,2] <- mean(grepl("Strongly agree" ,df$hire_vts)|grepl("Somewhat agree" ,df$hire_vts))*100
# 2) Column EI: Please indicate your level of agreement with the following statements. If you don’t know enough about VTS’s to answer,
#please leave it blank: - I would offer a higher salary for VTS’s compared to veterinary technicians without the specialist designation.
plotdf[3,1] <- "I would offer a higher salary for VTS’s compared to veterinary technicians\nwithout the specialist designation. (Overall)"
plotdf[3,2] <- mean(grepl("Strongly agree" ,d$high_sal_vts)|grepl("Somewhat agree" ,d$high_sal_vts))*100
plotdf[4,1] <- "I would offer a higher salary for VTS’s compared to veterinary technicians\nwithout the specialist designation. (Privately-owned practive)"
plotdf[4,2] <- mean(grepl("Strongly agree" ,df$high_sal_vts)|grepl("Somewhat agree" ,df$high_sal_vts))*100
p <- ggplot(data = plotdf, aes(x = question, y = perc_agree, fill=group)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = c("steelblue", "orange")) +
labs(title = "Percent agreement by practice type",
x = "",
y = "Percent somewhat or strongly agree") +
theme_minimal()+ coord_flip()
ggsave(p, file="C:/Users/andre/Dropbox/Becky help/Becky help - vet survey/percent_agree_by_practice_type.jpeg", width = 10, height = 5, units = "in", dpi = 300)
plotdf
plotdf <- data.frame(question=rep(NA,4), perc_agree=rep(NA,4), group=rep(c("Overall","Private"),2))
plotdf[1,1] <- "I would hire a Veterinary Technician Specialist (VTS) over a technician\nwithout the specialist designation if more VTS’s were available (Overall)"
plotdf[1,2] <- mean(grepl("Strongly agree" ,d$hire_vts)|grepl("Somewhat agree" ,d$hire_vts))*100
plotdf[2,1] <- "I would hire a Veterinary Technician Specialist (VTS) over a technician\nwithout the specialist designation if more VTS’s were available (Privately-owned practive)"
plotdf[2,2] <- mean(grepl("Strongly agree" ,df$hire_vts)|grepl("Somewhat agree" ,df$hire_vts))*100
# 2) Column EI: Please indicate your level of agreement with the following statements. If you don’t know enough about VTS’s to answer,
#please leave it blank: - I would offer a higher salary for VTS’s compared to veterinary technicians without the specialist designation.
plotdf[3,1] <- "I would offer a higher salary for VTS’s compared to veterinary technicians\nwithout the specialist designation. (Overall)"
plotdf[3,2] <- mean(grepl("Strongly agree" ,d$high_sal_vts)|grepl("Somewhat agree" ,d$high_sal_vts))*100
plotdf[4,1] <- "I would offer a higher salary for VTS’s compared to veterinary technicians\nwithout the specialist designation. (Privately-owned practive)"
plotdf[4,2] <- mean(grepl("Strongly agree" ,df$high_sal_vts)|grepl("Somewhat agree" ,df$high_sal_vts))*100
p <- ggplot(data = plotdf, aes(x = question, y = perc_agree, fill=group)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = c("steelblue", "orange")) +
labs(title = "Percent agreement by practice type",
x = "",
y = "Percent somewhat or strongly agree") +
theme_minimal()+ coord_flip() + theme(legend.position = "none") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave(p, file="C:/Users/andre/Dropbox/Becky help/Becky help - vet survey/percent_agree_by_practice_type.jpeg", width = 10, height = 5, units = "in", dpi = 300)
p <- ggplot(data = plotdf, aes(x = question, y = perc_agree, fill=group)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = c("orange","steelblue")) +
labs(title = "Percent agreement by practice type",
x = "",
y = "Percent somewhat or strongly agree") +
theme_minimal()+ coord_flip() + theme(legend.position = "none") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave(p, file="C:/Users/andre/Dropbox/Becky help/Becky help - vet survey/percent_agree_by_practice_type.jpeg", width = 10, height = 5, units = "in", dpi = 300)
colnames(d)[grepl("current patient load is too high", colnames(d))]
colnames(d)[grepl("negatively influence your mental health", colnames(d))]
colnames(d)[grepl("believe that euthanizing", colnames(d))]
colnames(d)[grepl("privately-owned, corporate-owned, or non-profit practice", colnames(d))]
colnames(d)[grepl("privately-owned,", colnames(d))]
colnames(d)[grepl("privately", colnames(d))]
colnames(d)[grepl("What type of practice do you primarily work in", colnames(d))]
colnames(d)[grepl("Which of the following best describes your current role?", colnames(d))]
unique(d$role)
colnames(d)[grepl("current patient load is too high", colnames(d))]
colnames(d)[grepl("negatively influence your mental health", colnames(d))]
colnames(d)[grepl("believe that euthanizing", colnames(d))]
colnames(d)[grepl("What type of practice do you primarily work in", colnames(d))]
d <- d %>% rename(work_life_balance=`Do you believe your current patient load is too high, too low, or about right for maintaining a sustainable work-life balance?`,
patient_load_mental_health=`To what extent does your patient load negatively influence your mental health?`,
euth_animal_mental_health=`To what extent do you believe that euthanizing  an animal because the owner could not afford the treatment you recommended influences your mental health?`,
practice_type=`What type of practice do you primarily work in? - Selected Choice`)
unique(d$work_life_balance)
unique(d$patient_load_mental_health)
unique(d$private_practice)
unique(d$role)
unique(d$practice_type)
table(d$work_life_balance, d$practice_type)
table(d$work_life_balance, d$private_practice)
table(d$work_life_balance, d$practice_type)
table(d$work_life_balance, d$role)
table(d$patient_load_mental_health, d$private_practice)
table(d$patient_load_mental_health, d$practice_type)
table(d$patient_load_mental_health, d$role)
prop.table(table(d$private_practice, d$work_life_balance),2)
prop.table(table(d$private_practice, d$work_life_balance),1)
prop.table(table(d$practice_type, d$work_life_balance),1)
prop.table(table(d$role, d$work_life_balance),1)
prop.table(table(d$private_practice, d$work_life_balance),1)
prop.table(table(d$practice_type, d$work_life_balance),1)
prop.table(table(d$role, d$work_life_balance),1)
colnames(d)[grepl("practice owners", colnames(d))]
colnames(d)[grepl(" discussions have occurred about the potential for policy clarifying what tasks are appropriate for delegation ", colnames(d))]
d <- d %>% rename(CVT=`Some discussions have occurred about the potential for policy clarifying what tasks are appropriate for delegation under specific levels of supervision by veterinarians to CVTs/RVTs. How helpful would this be for you to more efficiently work with the veterinary technicians in your practice?`,
DVM=`Some discussions have occurred about the potential for policy clarifying what tasks are appropriate for delegation under specific levels of supervision by veterinarians to CVTs/RVTs. How helpful would this be for you to more efficiently work with the veterinarians in your practice?`)
table(d$DVM)
table(d$CVT)
table(d$CVT,d$DVM)
# Perform the Chi-squared test
chi_squared_test <- chisq.test(table(d$CVT,d$DVM))
chi_squared_test
table(d$CVT)
table(d$DVM)
table(is.na(d$CVT),is.na(d$DVM))
d$CVT
table(d$CVT,d$DVM)
table(is.na(d$CVT),is.na(d$DVM))
# Perform the Chi-squared test -with missing added as a level
d$CVT <- factor(d$CVT, levels=c("Not at all helpful", "Slightly helpful", "Moderately helpful", "Very helpful", "Extremely helpful", "NA"))
table(d$CVT)
d$CVT <- addNA(d$CVT)
table(d$CVT)
d$DVM <- addNA(d$DVM)
table(d$DVM)
chi_squared_test <- chisq.test(table(d$CVT,d$DVM))
chi_squared_test
rm(list=ls())
library(tidyverse)
# Load the data
d <- readxl::read_excel("C:/Users/andre/Dropbox/Becky help/Becky help - vet survey/Vet_pro_survey_forR.xlsx")
head(d)
colnames(d)
#-------------------------------------------------------------------------------
#1. Are "practice owners/managers" (eg line 271) also DVMs? I assume so, but please clarify
#-------------------------------------------------------------------------------
#Analyze Column AB: Which of the following best describes your current role? (check all that apply) - Selected Choice
#-Specifically, how many selected “Practice manager/leadership position” or “Practice owner” who also selected “Veterinarian (DVM/VMD)”
#compared to only selected “Practice manager/leadership position” and/or “Practice owner” without also selecting “Veterinarian (DVM/VMD)”
colnames(d)[grepl("current role", colnames(d))]
d <- d %>% rename(role=`Which of the following best describes your current role? (check all that apply) - Selected Choice`)
unique(d$role)
#how many selected “Practice manager/leadership position” or “Practice owner” who also selected “Veterinarian (DVM/VMD)
n_num <- sum(grepl("Practice", d$role) & grepl("Veterinarian ", d$role))
n_num
n_num/length(d$role[!is.na(d$role)]) * 100
#only selected “Practice manager/leadership position” and/or “Practice owner” without also selecting “Veterinarian (DVM/VMD)
n_denom <- sum(grepl("Practice", d$role) & !grepl("Veterinarian ", d$role))
n_denom
n_num/length(d$role[!is.na(d$role)]) * 100
n_num/n_denom * 100
#-------------------------------------------------------------------------------
#2. How many of the Veterinary Professional respondents work for a corporate clinic vs an independently owned clinic?
#How many of the DVMs? I am particularly interested in this, as the answer to "would you pay more for a vet tech..."
#is irrelevant if they are not the deciders on what to pay. Somehow that information (how many of the respondents have control
#over business decisions, etc) needs to be included in this paper and in relation to the answers regarding hiring VTS, paying more, etc.
#Most DVMs I know fight hard to get their techs more money, and most work for large corporate practices and fail to get their techs that money.
#-------------------------------------------------------------------------------
#Analyze Column AB: Which of the following best describes your current role? (check all that apply) -
#  -selected “Veterinarian (DVM/VMD)” in Column AB by Column Y  (Do you work for a privately-owned, corporate-owned, or non-profit practice?)
colnames(d)[grepl("privately", colnames(d))]
d <- d %>% rename(private_practice=`Do you work for a privately-owned, corporate-owned, or non-profit practice?`)
unique(d$private_practice)
#True column is they selected vet as their role
table(grepl("Veterinarian", d$role), d$private_practice)
#marginal percents
prop.table(table(grepl("Veterinarian", d$role), d$private_practice),1)*100
prop.table(table(grepl("Veterinarian", d$role), d$private_practice),2)*100
#-selected ““Practice manager/leadership position” in Column AB and/or “Practice owner” in Column AB by Column Y  (Do you work for a privately-owned, corporate-owned, or non-profit practice?)
#True column is they selected vet as their role
table(grepl("manager/leadership", d$role), d$private_practice)
#marginal percents
prop.table(table(grepl("manager/leadership", d$role), d$private_practice),1)*100
prop.table(table(grepl("manager/leadership", d$role), d$private_practice),2)*100
#Create a figure with % somewhat or strongly agree OVERALL for the following as well as for the subsample for which:
# Column Y (Do you work for a privately-owned, corporate-owned, or non-profit practice?)= “privately-owned.”
# 1) Column EH: Please indicate your level of agreement with the following statements. If you don’t know enough about VTS’s to answer,
#please leave it blank: - I would hire a Veterinary Technician Specialist (VTS) over a technician without the specialist designation if more VTS’s were available.
colnames(d)[grepl("ould hire a Veterinary", colnames(d))]
colnames(d)[grepl("higher salary for VTS", colnames(d))]
d <- d %>% rename(hire_vts=`Please indicate your level of agreement with the following statements. If you don’t know enough about VTS’s to answer, please leave it blank: - I would hire a Veterinary Technician Specialist (VTS) over a technician without the specialist designation if more VTS’s were available.`,
high_sal_vts=`Please indicate your level of agreement with the following statements. If you don’t know enough about VTS’s to answer, please leave it blank: - I would offer a higher salary for VTS’s compared to veterinary technicians without the specialist designation.`)
unique(d$hire_vts)
unique(d$high_sal_vts)
#subset for privately-owned
df <- d[grepl("Privately owned " ,d$private_practice),]
plotdf <- data.frame(question=rep(NA,4), perc_agree=rep(NA,4), group=rep(c("Overall","Private"),2))
plotdf[1,1] <- "I would hire a Veterinary Technician Specialist (VTS) over a technician\nwithout the specialist designation if more VTS’s were available (Overall)"
plotdf[1,2] <- mean(grepl("Strongly agree" ,d$hire_vts)|grepl("Somewhat agree" ,d$hire_vts))*100
plotdf[2,1] <- "I would hire a Veterinary Technician Specialist (VTS) over a technician\nwithout the specialist designation if more VTS’s were available (Privately-owned practive)"
plotdf[2,2] <- mean(grepl("Strongly agree" ,df$hire_vts)|grepl("Somewhat agree" ,df$hire_vts))*100
# 2) Column EI: Please indicate your level of agreement with the following statements. If you don’t know enough about VTS’s to answer,
#please leave it blank: - I would offer a higher salary for VTS’s compared to veterinary technicians without the specialist designation.
plotdf[3,1] <- "I would offer a higher salary for VTS’s compared to veterinary technicians\nwithout the specialist designation. (Overall)"
plotdf[3,2] <- mean(grepl("Strongly agree" ,d$high_sal_vts)|grepl("Somewhat agree" ,d$high_sal_vts))*100
plotdf[4,1] <- "I would offer a higher salary for VTS’s compared to veterinary technicians\nwithout the specialist designation. (Privately-owned practive)"
plotdf[4,2] <- mean(grepl("Strongly agree" ,df$high_sal_vts)|grepl("Somewhat agree" ,df$high_sal_vts))*100
p <- ggplot(data = plotdf, aes(x = question, y = perc_agree, fill=group)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = c("orange","steelblue")) +
labs(title = "Percent agreement by practice type",
x = "",
y = "Percent somewhat or strongly agree") +
theme_minimal()+ coord_flip() + theme(legend.position = "none") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave(p, file="C:/Users/andre/Dropbox/Becky help/Becky help - vet survey/percent_agree_by_practice_type.jpeg", width = 10, height = 5, units = "in", dpi = 300)
#-------------------------------------------------------------------------------
#Ll. 221 ff: Did you check for any associations between mental health and demographics or professions?
#-------------------------------------------------------------------------------
colnames(d)[grepl("current patient load is too high", colnames(d))]
colnames(d)[grepl("negatively influence your mental health", colnames(d))]
colnames(d)[grepl("believe that euthanizing", colnames(d))]
colnames(d)[grepl("What type of practice do you primarily work in", colnames(d))]
d <- d %>% rename(work_life_balance=`Do you believe your current patient load is too high, too low, or about right for maintaining a sustainable work-life balance?`,
patient_load_mental_health=`To what extent does your patient load negatively influence your mental health?`,
euth_animal_mental_health=`To what extent do you believe that euthanizing  an animal because the owner could not afford the treatment you recommended influences your mental health?`,
practice_type=`What type of practice do you primarily work in? - Selected Choice`)
unique(d$work_life_balance)
unique(d$patient_load_mental_health)
unique(d$euth_animal_mental_health)
unique(d$private_practice)
unique(d$role)
unique(d$practice_type)
#  Column AR: Do you believe your current patient load is too high, too low, or
# about right for maintaining a sustainable work-life balance?
#  AND
# Column AS: To what extent does your patient load negatively influence your mental health?
#  AND
#Column AY: To what extent do you believe that euthanizing  an animal because the owner could not afford the treatment you recommended influences your mental health?
#  BY
#Column Y: Do you work for a privately-owned, corporate-owned, or non-profit practice?
#  AND
#Column W: What type of practice do you primarily work in? - Selected Choice
#AND
#Column AB: Which of the following best describes your current role? (check all that apply) - Selected Choice
#-With the following buckets:
#  -Registered/certified veterinary technician or non-credentialed veterinary technician
#-Veterinarian (DVM/VMD)
prop.table(table(d$private_practice, d$work_life_balance),1)
prop.table(table(d$practice_type, d$work_life_balance),1)
prop.table(table(d$role, d$work_life_balance),1)
prop.table(table(d$private_practice, d$patient_load_mental_health),1)
prop.table(table(d$practice_type, d$patient_load_mental_health),1)
prop.table(table(d$role, d$patient_load_mental_health),1)
prop.table(table(d$private_practice, d$euth_animal_mental_health),1)
prop.table(table(d$practice_type, d$euth_animal_mental_health),1)
prop.table(table(d$role, d$euth_animal_mental_health),1)
#-------------------------------------------------------------------------------
#ll. 261-264: Did you check if the differences between DVMs and CVTs were statistically significant?
#-------------------------------------------------------------------------------
#  Check if means are statistically significant:
#  DVMs/practice owners = Column CZ
#CVTs= Column EZ
d <- d %>% rename(CVT=`Some discussions have occurred about the potential for policy clarifying what tasks are appropriate for delegation under specific levels of supervision by veterinarians to CVTs/RVTs. How helpful would this be for you to more efficiently work with the veterinary technicians in your practice?`,
DVM=`Some discussions have occurred about the potential for policy clarifying what tasks are appropriate for delegation under specific levels of supervision by veterinarians to CVTs/RVTs. How helpful would this be for you to more efficiently work with the veterinarians in your practice?`)
table(d$CVT)
table(d$DVM)
table(d$CVT,d$DVM)
table(is.na(d$CVT),is.na(d$DVM))
# Perform the Chi-squared test - including missingness, though it is very high
chi_squared_test <- chisq.test(table(d$CVT,d$DVM))
chi_squared_test
# Perform the Chi-squared test -with missing added as a level
d$CVT <- addNA(d$CVT)
d$DVM <- addNA(d$DVM)
table(d$CVT,d$DVM)
chi_squared_test <- chisq.test(table(d$CVT,d$DVM))
chi_squared_test
?table
table(d$CVT,d$DVM, dnn = c("CVT", "DVM"))
colnames(d)[grepl("Do you think more CVTs obtaining a VTS designation would....", colnames(d))]
table(d$CVT_pos)
table(d$DVM_pos)
d <- d %>% rename(DVM_pos=`Do you think more CVTs obtaining a VTS designation would.... - positively benefit the profession?...141`,
CVT_pos=`Do you think more CVTs obtaining a VTS designation would.... - positively benefit the profession?...182`)
table(d$CVT_pos)
table(d$DVM_pos)
table(d$CVT_pos)
table(d$DVM_pos)
table(d$CVT_pos,d$DVM_pos, dnn = c("CVT_pos", "DVM_pos"))
table(is.na(d$CVT_pos),is.na(d$DVM_pos))
# Perform the Chi-squared test - including missingness, though it is very high
chi_squared_test <- chisq.test(table(d$CVT_pos,d$DVM_pos))
chi_squared_test
# Perform the Chi-squared test -with missing added as a level
d$CVT_pos <- addNA(d$CVT_pos)
d$DVM_pos <- addNA(d$DVM_pos)
table(d$CVT_pos,d$DVM_pos, dnn = c("CVT_pos", "DVM_pos"))
chi_squared_test <- chisq.test(table(d$CVT_pos,d$DVM_pos))
chi_squared_test
rm(list=ls())
library(tidyverse)
# Load the data
d <- readxl::read_excel("C:/Users/andre/Dropbox/Becky help/Becky help - vet survey/Vet_pro_survey_forR.xlsx")
head(d)
colnames(d)
#-------------------------------------------------------------------------------
#1. Are "practice owners/managers" (eg line 271) also DVMs? I assume so, but please clarify
#-------------------------------------------------------------------------------
#Analyze Column AB: Which of the following best describes your current role? (check all that apply) - Selected Choice
#-Specifically, how many selected “Practice manager/leadership position” or “Practice owner” who also selected “Veterinarian (DVM/VMD)”
#compared to only selected “Practice manager/leadership position” and/or “Practice owner” without also selecting “Veterinarian (DVM/VMD)”
colnames(d)[grepl("current role", colnames(d))]
d <- d %>% rename(role=`Which of the following best describes your current role? (check all that apply) - Selected Choice`)
unique(d$role)
#how many selected “Practice manager/leadership position” or “Practice owner” who also selected “Veterinarian (DVM/VMD)
n_num <- sum(grepl("Practice", d$role) & grepl("Veterinarian ", d$role))
n_num
n_num/length(d$role[!is.na(d$role)]) * 100
#only selected “Practice manager/leadership position” and/or “Practice owner” without also selecting “Veterinarian (DVM/VMD)
n_denom <- sum(grepl("Practice", d$role) & !grepl("Veterinarian ", d$role))
n_denom
n_num/length(d$role[!is.na(d$role)]) * 100
n_num/n_denom * 100
#-------------------------------------------------------------------------------
#2. How many of the Veterinary Professional respondents work for a corporate clinic vs an independently owned clinic?
#How many of the DVMs? I am particularly interested in this, as the answer to "would you pay more for a vet tech..."
#is irrelevant if they are not the deciders on what to pay. Somehow that information (how many of the respondents have control
#over business decisions, etc) needs to be included in this paper and in relation to the answers regarding hiring VTS, paying more, etc.
#Most DVMs I know fight hard to get their techs more money, and most work for large corporate practices and fail to get their techs that money.
#-------------------------------------------------------------------------------
#Analyze Column AB: Which of the following best describes your current role? (check all that apply) -
#  -selected “Veterinarian (DVM/VMD)” in Column AB by Column Y  (Do you work for a privately-owned, corporate-owned, or non-profit practice?)
colnames(d)[grepl("privately", colnames(d))]
d <- d %>% rename(private_practice=`Do you work for a privately-owned, corporate-owned, or non-profit practice?`)
unique(d$private_practice)
#True column is they selected vet as their role
table(grepl("Veterinarian", d$role), d$private_practice)
#marginal percents
prop.table(table(grepl("Veterinarian", d$role), d$private_practice),1)*100
prop.table(table(grepl("Veterinarian", d$role), d$private_practice),2)*100
#-selected ““Practice manager/leadership position” in Column AB and/or “Practice owner” in Column AB by Column Y  (Do you work for a privately-owned, corporate-owned, or non-profit practice?)
#True column is they selected vet as their role
table(grepl("manager/leadership", d$role), d$private_practice)
#marginal percents
prop.table(table(grepl("manager/leadership", d$role), d$private_practice),1)*100
prop.table(table(grepl("manager/leadership", d$role), d$private_practice),2)*100
#Create a figure with % somewhat or strongly agree OVERALL for the following as well as for the subsample for which:
# Column Y (Do you work for a privately-owned, corporate-owned, or non-profit practice?)= “privately-owned.”
# 1) Column EH: Please indicate your level of agreement with the following statements. If you don’t know enough about VTS’s to answer,
#please leave it blank: - I would hire a Veterinary Technician Specialist (VTS) over a technician without the specialist designation if more VTS’s were available.
colnames(d)[grepl("ould hire a Veterinary", colnames(d))]
colnames(d)[grepl("higher salary for VTS", colnames(d))]
d <- d %>% rename(hire_vts=`Please indicate your level of agreement with the following statements. If you don’t know enough about VTS’s to answer, please leave it blank: - I would hire a Veterinary Technician Specialist (VTS) over a technician without the specialist designation if more VTS’s were available.`,
high_sal_vts=`Please indicate your level of agreement with the following statements. If you don’t know enough about VTS’s to answer, please leave it blank: - I would offer a higher salary for VTS’s compared to veterinary technicians without the specialist designation.`)
unique(d$hire_vts)
unique(d$high_sal_vts)
#subset for privately-owned
df <- d[grepl("Privately owned " ,d$private_practice),]
plotdf <- data.frame(question=rep(NA,4), perc_agree=rep(NA,4), group=rep(c("Overall","Private"),2))
plotdf[1,1] <- "I would hire a Veterinary Technician Specialist (VTS) over a technician\nwithout the specialist designation if more VTS’s were available (Overall)"
plotdf[1,2] <- mean(grepl("Strongly agree" ,d$hire_vts)|grepl("Somewhat agree" ,d$hire_vts))*100
plotdf[2,1] <- "I would hire a Veterinary Technician Specialist (VTS) over a technician\nwithout the specialist designation if more VTS’s were available (Privately-owned practive)"
plotdf[2,2] <- mean(grepl("Strongly agree" ,df$hire_vts)|grepl("Somewhat agree" ,df$hire_vts))*100
# 2) Column EI: Please indicate your level of agreement with the following statements. If you don’t know enough about VTS’s to answer,
#please leave it blank: - I would offer a higher salary for VTS’s compared to veterinary technicians without the specialist designation.
plotdf[3,1] <- "I would offer a higher salary for VTS’s compared to veterinary technicians\nwithout the specialist designation. (Overall)"
plotdf[3,2] <- mean(grepl("Strongly agree" ,d$high_sal_vts)|grepl("Somewhat agree" ,d$high_sal_vts))*100
plotdf[4,1] <- "I would offer a higher salary for VTS’s compared to veterinary technicians\nwithout the specialist designation. (Privately-owned practive)"
plotdf[4,2] <- mean(grepl("Strongly agree" ,df$high_sal_vts)|grepl("Somewhat agree" ,df$high_sal_vts))*100
p <- ggplot(data = plotdf, aes(x = question, y = perc_agree, fill=group)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = c("orange","steelblue")) +
labs(title = "Percent agreement by practice type",
x = "",
y = "Percent somewhat or strongly agree") +
theme_minimal()+ coord_flip() + theme(legend.position = "none") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave(p, file="C:/Users/andre/Dropbox/Becky help/Becky help - vet survey/percent_agree_by_practice_type.jpeg", width = 10, height = 5, units = "in", dpi = 300)
#-------------------------------------------------------------------------------
#Ll. 221 ff: Did you check for any associations between mental health and demographics or professions?
#-------------------------------------------------------------------------------
colnames(d)[grepl("current patient load is too high", colnames(d))]
colnames(d)[grepl("negatively influence your mental health", colnames(d))]
colnames(d)[grepl("believe that euthanizing", colnames(d))]
colnames(d)[grepl("What type of practice do you primarily work in", colnames(d))]
d <- d %>% rename(work_life_balance=`Do you believe your current patient load is too high, too low, or about right for maintaining a sustainable work-life balance?`,
patient_load_mental_health=`To what extent does your patient load negatively influence your mental health?`,
euth_animal_mental_health=`To what extent do you believe that euthanizing  an animal because the owner could not afford the treatment you recommended influences your mental health?`,
practice_type=`What type of practice do you primarily work in? - Selected Choice`)
unique(d$work_life_balance)
unique(d$patient_load_mental_health)
unique(d$euth_animal_mental_health)
unique(d$private_practice)
unique(d$role)
unique(d$practice_type)
#  Column AR: Do you believe your current patient load is too high, too low, or
# about right for maintaining a sustainable work-life balance?
#  AND
# Column AS: To what extent does your patient load negatively influence your mental health?
#  AND
#Column AY: To what extent do you believe that euthanizing  an animal because the owner could not afford the treatment you recommended influences your mental health?
#  BY
#Column Y: Do you work for a privately-owned, corporate-owned, or non-profit practice?
#  AND
#Column W: What type of practice do you primarily work in? - Selected Choice
#AND
#Column AB: Which of the following best describes your current role? (check all that apply) - Selected Choice
#-With the following buckets:
#  -Registered/certified veterinary technician or non-credentialed veterinary technician
#-Veterinarian (DVM/VMD)
prop.table(table(d$private_practice, d$work_life_balance),1)
prop.table(table(d$practice_type, d$work_life_balance),1)
prop.table(table(d$role, d$work_life_balance),1)
prop.table(table(d$private_practice, d$patient_load_mental_health),1)
prop.table(table(d$practice_type, d$patient_load_mental_health),1)
prop.table(table(d$role, d$patient_load_mental_health),1)
prop.table(table(d$private_practice, d$euth_animal_mental_health),1)
prop.table(table(d$practice_type, d$euth_animal_mental_health),1)
prop.table(table(d$role, d$euth_animal_mental_health),1)
#-------------------------------------------------------------------------------
#ll. 261-264: Did you check if the differences between DVMs and CVTs were statistically significant?
#-------------------------------------------------------------------------------
#  Check if means are statistically significant:
#  DVMs/practice owners = Column CZ
#CVTs= Column EZ
d <- d %>% rename(CVT=`Some discussions have occurred about the potential for policy clarifying what tasks are appropriate for delegation under specific levels of supervision by veterinarians to CVTs/RVTs. How helpful would this be for you to more efficiently work with the veterinary technicians in your practice?`,
DVM=`Some discussions have occurred about the potential for policy clarifying what tasks are appropriate for delegation under specific levels of supervision by veterinarians to CVTs/RVTs. How helpful would this be for you to more efficiently work with the veterinarians in your practice?`)
table(d$CVT)
table(d$DVM)
d$DVM
class(d$DVM)
table(d$DVM)
DVM_numeric <- as.numeric(factor(d$DVM, levels=c("Not at all helpful", "Slightly helpful", "Moderately helpful", "Very helpful", "Extremely helpful")))
CVT_numeric <- as.numeric(factor(d$CVT, levels=c("Not at all helpful", "Slightly helpful", "Moderately helpful", "Very helpful", "Extremely helpful")))
t.test(DVM_numeric, CVT_numeric)
3.575269-  2.893443
colnames(d)[grepl("Do you think more CVTs obtaining a VTS designation would....", colnames(d))]
d <- d %>% rename(DVM_pos=`Do you think more CVTs obtaining a VTS designation would.... - positively benefit the profession?...141`,
CVT_pos=`Do you think more CVTs obtaining a VTS designation would.... - positively benefit the profession?...182`)
table(d$CVT_pos)
table(d$DVM_pos)
CVT_pos_numeric <- as.numeric(factor(d$CVT_pos, levels=c("No", "Not sure","Yes")))
DVM_pos_numeric <- as.numeric(factor(d$DVM_pos, levels=c("No", "Not sure","Yes")))
t.test(DVM_pos_numeric, CVT_pos_numeric)
rm(list=ls())
#source(here::here("0_config.R"))
#library(boxr)
#box_auth()
#updated_pregnancy <- box_read(845078269128)
# read in data
#d <- readRDS("./stress_growth.RDS")
d <- readRDS("data/bangladesh-cleaned-master-data.RDS")
table(d$vit_A_def)
summary(d$logFERR)
summary(d$logFERR_inf)
#dfull <- readRDS("./stress_growth.RDS")
# select variables/columns of interest
exp_out <- c('dataid', 'childid', 'clusterid', 'ln_preg_cort', 'logRBP_inf','logSTFR_inf','vitD_nmol_per_L', 'ln_preg_estri', 'logCRP', 'logAGP', 'sumscore_t0_mom_Z', 'igf_t2', 'igf_t3', 'laz_t1', 'laz_t2', 'laz_t3')
cov <- c("sex","birthord", "momage","momheight","momedu",
"hfiacat", "Nlt18","Ncomp", "watmin", "walls", "floor", "HHwealth_scaled",
"tr", "life_viol_any_t3_cat", "viol_any_preg_cat", "roof", "life_viol_any_t3", "viol_any_preg")
time_cov <- c("ageday_bt2", "month_blood_t0", "month_bt2", "ageday_bt3", "month_blood_t0", "month_bt3","time_of_day_cort_cont")
extract <- c(exp_out, cov, time_cov)
d <- d %>% select(all_of(extract)) %>% mutate(childid = as.integer(childid)) %>% mutate(dataid = as.integer(dataid))
source(here::here("0_config.R"))
rm(list=ls())
source(here::here("0_config.R"))
source("~/washb_substudies/pregnancy-stress-growth/0_config.R")
devtools::install_github("washb-eed-substudies/washbgam")
devtools::install_github("ben-arnold/washb"")
devtools::install_github("ben-arnold/washb"")
devtools::install_github("ben-arnold/washb")
devtools::install_github("washb-eed-substudies/washbgam")
